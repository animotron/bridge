/*
* Kendo UI v2011.3.1129 (http://kendoui.com)
* Copyright 2011 Telerik AD. All rights reserved.
*
* Kendo UI commercial licenses may be obtained at http://kendoui.com/license.
* If you do not own a commercial license, this file shall be governed by the
* GNU General Public License (GPL) version 3. For GPL requirements, please
* review: http://www.gnu.org/copyleft/gpl.html
*/

(function(a,b){function J(a){var b=this;b.owner=a,b._draggable=new e(a.wrapper,{filter:n,group:a.wrapper.id+"-moving",dragstart:h(b.dragstart,b),drag:h(b.drag,b),dragend:h(b.dragend,b)})}function I(a){var b=this;b.owner=a,b._draggable=new e(a.wrapper,{filter:".k-resize-handle",group:a.wrapper.id+"-resizing",dragstart:h(b.dragstart,b),drag:h(b.drag,b),dragend:h(b.dragend,b)})}function H(b,c){var d=a(b);typeof c.scrollable!="undefined"&&c.scrollable===!1&&d.attr("style","overflow:hidden;"),c.content&&!D(c.content)&&d.html(l.iframe(c)),a(l.wrapper(c)).append(l.titlebar(c)).append(d).appendTo(k)}function F(){return a(m).filter(function(){var b=a(this);return b.is(s)&&E(b).options.modal})}function E(a){return a.children(o).data("kendoWindow")}var c=window.kendo,d=c.ui.Widget,e=c.ui.Draggable,f=c.fx,g=a.isPlainObject,h=a.proxy,i=a.each,j=c.template,k,l,m=".k-window",n=".k-window-titlebar",o=".k-window-content",p=".k-overlay",q="k-loading",r="k-state-hover",s=":visible",t="cursor",u="open",v="activate",w="deactivate",x="close",y="refresh",z="resize",A="dragend",B="error",C="overflow",D=c.isLocalUrl,G=d.extend({init:function(b,c){var e=this,f,g=".k-window-titlebar .k-window-action",j,o,p=!1;k=document.body,d.fn.init.call(e,b,c),c=e.options,b=e.element,c.animation===!1&&(c.animation={open:{show:!0,effects:{}},close:{hide:!0,effects:{}}});if(!b.parent().is("body"))if(b.is(s))o=b.offset(),p=!0;else{var q=b.css("visibility"),t=b.css("display");b.css({visibility:"hidden",display:""}),o=b.offset(),b.css({visibility:q,display:t})}f=e.wrapper=b.closest(m);if(!b.is(".k-content")||!f[0])b.addClass("k-window-content k-content"),H(b,c),f=e.wrapper=b.closest(m),j=e.wrapper.find(n),j.css("margin-top",-j.outerHeight()),f.css("padding-top",j.outerHeight()),c.width&&f.width(c.width),c.height&&f.height(c.height),a.each(["minWidth","minHeight","maxWidth","maxHeight"],function(a,b){var d=c[b];d&&d!=Infinity&&f.css(b,d)}),c.visible||f.hide();o&&(p?f.css({top:o.top,left:o.left}):f.css({top:o.top,left:o.left,visibility:"visible",display:"none"})),f.toggleClass("k-rtl",e.wrapper.closest(".k-rtl").length).appendTo(k),e.toFront(),c.modal&&e._overlay(f.is(s)).css({opacity:.5}),f.bind("mousedown",h(e.toFront,e)).delegate(g,"mouseenter",function(){a(this).addClass(r)}).delegate(g,"mouseleave",function(){a(this).removeClass(r)}).delegate(g,"click",h(e._windowActionHandler,e)),c.resizable&&(f.delegate(n,"dblclick",h(e.toggleMaximization,e)),i("n e s w se sw ne nw".split(" "),function(a,b){f.append(l.resizeHandle(b))}),e.resizing=new I(e)),c.draggable&&(e.dragging=new J(e)),e.bind([u,v,w,x,y,z,A,B],c),a(window).resize(h(e._onDocumentResize,e)),a.isPlainObject(c.content)||(c.content={url:c.content}),D(c.content.url)&&e._ajaxRequest(c.content),f.is(s)&&(e.trigger(u),e.trigger(v))},options:{name:"Window",animation:{open:{effects:{zoomIn:{},fadeIn:{}},duration:350,show:!0},close:{effects:{zoomOut:{properties:{scale:.7}},fadeOut:{}},duration:350,hide:!0}},title:"",actions:["Close"],modal:!1,resizable:!0,draggable:!0,minWidth:50,minHeight:50,maxWidth:Infinity,maxHeight:Infinity,visible:!0},_overlay:function(b){var c=a("body > .k-overlay"),d=a(document),e=this.wrapper[0];c.length==0?c=a("<div class='k-overlay' />").toggle(b).insertBefore(e):c.insertBefore(e).toggle(b);return c},_windowActionHandler:function(b){var c=a(b.target).closest(".k-window-action").find(".k-icon"),d=this;i({"k-close":d.close,"k-maximize":d.maximize,"k-restore":d.restore,"k-refresh":d.refresh},function(a,e){if(c.hasClass(a)){b.preventDefault(),e.call(d);return!1}})},center:function(){var b=this.wrapper,c=a(window);b.css({left:c.scrollLeft()+Math.max(0,(c.width()-b.width())/2),top:c.scrollTop()+Math.max(0,(c.height()-b.height())/2)});return this},title:function(b){var c=a(".k-window-titlebar > .k-window-title",this.wrapper);if(!b)return c.text();c.text(b);return this},content:function(a){var b=this.wrapper.children(o);if(!a)return b.html();b.html(a);return this},open:function(){var b=this,c=b.wrapper,d=b.options.animation.open,e=c.children(o),f=e.css(C);if(!b.trigger(u)){if(b.options.modal){var g=b._overlay(!1);d.duration?g.kendoStop().kendoAnimate({effects:{fadeOut:{properties:{opacity:.5}}},duration:d.duration,show:!0}):g.css("opacity",.5).show()}c.is(s)||(e.css(C,"hidden"),c.show().kendoStop().kendoAnimate({effects:d.effects,duration:d.duration,complete:function(){b.trigger(v),e.css(C,f)}})),b.toFront()}b.options.isMaximized&&a("html, body").css(C,"hidden");return b},close:function(){var c=this,d=c.wrapper,e=c.options,f=e.animation.close,g,h,i;d.is(s)&&!c.trigger(x)&&(g=F(),h=e.modal&&g.length==1,i=e.modal?c._overlay(!0):a(b),h?f.duration?i.kendoStop().kendoAnimate({effects:{fadeOut:{properties:{opacity:0}}},duration:f.duration,hide:!0}):i.hide():g.length&&E(g.eq(g.length-2))._overlay(!0),d.kendoStop().kendoAnimate({effects:f.effects,duration:f.duration,complete:function(){d.hide(),c.trigger(w)}})),c.options.isMaximized&&a("html, body").css(C,"");return c},toFront:function(){var b=this,c=b.wrapper,d=c[0],e=+c.css("zIndex");a(m).each(function(b,c){var f=a(c),g=f.css("zIndex"),h=f.find(".k-window-content");isNaN(g)||(e=Math.max(+g,e)),c!=d&&h.find("> .k-content-frame").length>0&&h.append(l.overlay)}),c.css("zIndex",e+2),b.element.find("> .k-overlay").remove();return b},toggleMaximization:function(){return this[this.options.isMaximized?"restore":"maximize"]()},restore:function(){var b=this,c=b.options,d=b.restorationSettings;if(!!c.isMaximized){b.wrapper.css({position:"absolute",left:d.left,top:d.top,width:d.width,height:d.height}).find(".k-resize-handle").show().end().find(".k-window-titlebar .k-restore").addClass("k-maximize").removeClass("k-restore"),a("html, body").css(C,""),c.isMaximized=!1,b.trigger(z);return b}},maximize:function(){var b=this;if(!b.options.isMaximized){var c=b.wrapper;b.restorationSettings={left:c.position().left,top:c.position().top,width:c.width(),height:c.height()},c.css({left:0,top:0,position:"fixed"}).find(".k-resize-handle").hide().end().find(".k-window-titlebar .k-maximize").addClass("k-restore").removeClass("k-maximize"),a("html, body").css(C,"hidden"),b.options.isMaximized=!0,b._onDocumentResize();return b}},_onDocumentResize:function(){var b=this,c=b.wrapper,d=a(window);!b.options.isMaximized||(c.css({width:d.width(),height:d.height()}),b.trigger(z))},refresh:function(b){a.isPlainObject(b)||(b={url:b});var c=this,d=b.url=b.url||c.options.content.url;D(d)&&c._ajaxRequest(b);return c},_ajaxRequest:function(b){var c=this,d=c.wrapper.find(".k-window-titlebar .k-refresh"),e=setTimeout(function(){d.addClass(q)},100);a.ajax(a.extend({type:"GET",dataType:"html",cache:!1,error:h(function(a,b){c.trigger(B)},c),complete:function(){clearTimeout(e),d.removeClass(q)},success:h(function(a,b){c.wrapper.children(o).html(a),c.trigger(y)},c)},c.options.content,b))},destroy:function(){var a=this,b,c;a.wrapper.remove(),b=F(),c=a.options.modal&&!b.length,c?a._overlay(!1).remove():b.length>0&&E(b.eq(b.length-2))._overlay(!0)}});l={wrapper:j("<div class='k-widget k-window' />"),titlebar:j("<div class='k-window-titlebar k-header'>&nbsp;<span class='k-window-title'>#= title #</span><div class='k-window-actions k-header'># for (var i = 0; i < actions.length; i++) { #<a href='\\#' class='k-window-action k-link'><span class='k-icon k-#= actions[i].toLowerCase() #'>#= actions[i] #</span></a># } #</div></div>"),overlay:"<div class='k-overlay' />",iframe:j("<iframe src='#= content #' title='#= title #' frameborder='0' class='k-content-frame'>This page requires frames in order to show content</iframe>"),resizeHandle:j("<div class='k-resize-handle k-resize-#= data #'></div>")},I.prototype={dragstart:function(b){var c=this.owner,d=c.wrapper;c.elementPadding=parseInt(c.wrapper.css("padding-top")),c.initialCursorPosition=d.offset(),c.resizeDirection=b.currentTarget.prop("className").replace("k-resize-handle k-resize-","").split(""),c.initialSize={width:c.wrapper.width(),height:c.wrapper.height()},d.append(l.overlay).find(".k-resize-handle").not(b.currentTarget).hide(),a(k).css(t,b.currentTarget.css(t))},drag:function(a){var b=this.owner,c=b.wrapper,d=b.options,e=function(a,b,c){return Math.max(Math.min(a,c),b)},f={e:function(){var f=a.pageX-b.initialCursorPosition.left;c.width(e(f,d.minWidth,d.maxWidth))},s:function(){var f=a.pageY-b.initialCursorPosition.top-b.elementPadding;c.height(e(f,d.minHeight,d.maxHeight))},w:function(){var f=b.initialCursorPosition.left+b.initialSize.width,g=e(f-a.pageX,d.minWidth,d.maxWidth);c.css({left:f-g,width:g})},n:function(){var f=b.initialCursorPosition.top+b.initialSize.height,g=e(f-a.pageY,d.minHeight,d.maxHeight);c.css({top:f-g,height:g})}};i(b.resizeDirection,function(){f[this]()}),b.trigger(z)},dragend:function(b){var c=this.owner,d=c.wrapper;d.find(p).remove().end().find(".k-resize-handle").not(b.currentTarget).show(),a(k).css(t,""),b.keyCode==27&&d.css(c.initialCursorPosition).css(c.initialSize);return!1}},J.prototype={dragstart:function(b){var c=this.owner,d=a(c.element);c.initialWindowPosition=c.wrapper.position(),c.startPosition={left:b.pageX-c.initialWindowPosition.left,top:b.pageY-c.initialWindowPosition.top};var e=d.find(".k-window-actions");e.length>0?c.minLeftPosition=e.outerWidth()+parseInt(e.css("right"),10)-d.outerWidth():c.minLeftPosition=20-d.outerWidth(),c.wrapper.append(l.overlay).find(".k-resize-handle").hide(),a(k).css(t,b.currentTarget.css(t))},drag:function(b){var c=this.owner,d={left:Math.max(b.pageX-c.startPosition.left,c.minLeftPosition),top:Math.max(b.pageY-c.startPosition.top,0)};a(c.wrapper).css(d)},dragend:function(b){var c=this.owner;c.wrapper.find(".k-resize-handle").show().end().find(p).remove(),a(k).css(t,""),b.keyCode==27?b.currentTarget.closest(m).css(c.initialWindowPosition):c.trigger(A);return!1}},c.ui.plugin(G)})(jQuery)