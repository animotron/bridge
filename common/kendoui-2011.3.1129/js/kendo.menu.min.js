/*
* Kendo UI v2011.3.1129 (http://kendoui.com)
* Copyright 2011 Telerik AD. All rights reserved.
*
* Kendo UI commercial licenses may be obtained at http://kendoui.com/license.
* If you do not own a commercial license, this file shall be governed by the
* GNU General Public License (GPL) version 3. For GPL requirements, please
* review: http://www.gnu.org/copyleft/gpl.html
*/

(function(a,b){function N(b){b=a(b),b.filter(".k-first:not(:first-child)").removeClass(t),b.filter(".k-last:not(:last-child)").removeClass(p),b.filter(":first-child").addClass(t),b.filter(":last-child").addClass(p)}function M(b){b=a(b),b.find(".k-icon").remove(),b.filter(":has(.k-group)").children(".k-link:not(:has([class*=k-arrow]))").each(function(){var b=a(this),c=b.parent().parent();b.append("<span class='k-icon "+(c.hasClass(n+"-horizontal")?"k-arrow-down":"k-arrow-next")+"'/>")})}function L(b){b=a(b),b.children(l).addClass(u),b.children("a").addClass(o).children(l).addClass(u),b.filter(":not([disabled])").addClass(C),b.filter(".k-separator:empty").append("&nbsp;"),b.filter("li[disabled]").addClass(D).removeAttr("disabled"),b.children("a:focus").parent().addClass("k-state-active"),b.children("."+o).length||b.contents().filter(function(){return!this.nodeName.match(k)&&(this.nodeType!=3||!!a.trim(this.nodeValue))}).wrapAll("<span class='"+o+"'/>"),M(b),N(b)}function K(b,c){try{return a.contains(b,c)}catch(d){return!1}}function J(a){var b=a.parent();return{effects:b.hasClass(n)?b.hasClass(n+"-vertical")?B:"slideIn:down":B}}var c=window.kendo,d=c.ui,e=c.support.touch,f=a.extend,g=a.proxy,h=a.each,i=c.template,j=d.Widget,k=/^(ul|a|div)$/i,l="img",m="open",n="k-menu",o="k-link",p="k-last",q="close",r="click",s="timer",t="k-first",u="k-image",v=":empty",w="select",x="zIndex",y="mouseenter",z="mouseleave",A="kendoPopup",B="slideIn:right",C="k-state-default",D="k-state-disabled",E=".k-item.k-state-disabled",F=".k-item:not(.k-state-disabled)",G=".k-item:not(.k-state-disabled) > .k-link",H={group:i("<ul class='#= groupCssClass(group) #'#= groupAttributes(group) #>#= renderItems(data) #</ul>"),itemWrapper:i("<#= tag(item) # class='#= textClass(item) #'#= textAttributes(item) #>#= image(item) ##= sprite(item) ##= text(item) ##= arrow(data) #</#= tag(item) #>"),item:i("<li class='#= wrapperCssClass(group, item) #'>#= itemWrapper(data) ## if (item.items) { ##= subGroup({ items: item.items, menu: menu, group: { expanded: item.expanded } }) ## } #</li>"),image:i("<img class='k-image' alt='' src='#= imageUrl #' />"),arrow:i("<span class='#= arrowClass(item, group) #'></span>"),sprite:i("<span class='k-sprite #= spriteCssClass #'></span>"),empty:i("")},I={wrapperCssClass:function(a,b){var c="k-item",d=b.index;b.enabled===!1?c+=" k-state-disabled":c+=" k-state-default",a.firstLevel&&d==0&&(c+=" k-first"),d==a.length-1&&(c+=" k-last");return c},textClass:function(a){return o},textAttributes:function(a){return a.url?" href='"+a.url+"'":""},arrowClass:function(a,b){var c="k-icon";b.horizontal?c+=" k-arrow-down":c+=" k-arrow-right";return c},text:function(a){return a.encoded===!1?a.text:c.htmlEncode(a.text)},tag:function(a){return a.url?"a":"span"},groupAttributes:function(a){return a.expanded!==!0?" style='display:none'":""},groupCssClass:function(a){return"k-group"}},O=j.extend({init:function(b,c){b=a(b);var d=this;j.fn.init.call(d,b,c),c=d.options,d.element.is(v)&&d.element.append(a(O.renderGroup({items:c.dataSource,group:{firstLevel:!0,horizontal:d.element.hasClass(n+"-horizontal"),expanded:!0},menu:{}})).children()),d._updateClasses(),c.animation===!1&&(c.animation={open:{show:!0,effects:{}},close:{hide:!0,effects:{}}}),d.nextItemZIndex=100,b.delegate(E,r,!1),b.delegate(F,y,g(d._mouseenter,d)).delegate(F,z,g(d._mouseleave,d)).delegate(F,r,g(d._click,d)),b.delegate(G,y+" "+z,d._toggleHover),a(document).click(g(d._documentClick,d)),d.clicked=!1,d.bind([m,q,w],d.options)},options:{name:"Menu",animation:{open:{duration:200,show:!0},close:{duration:100,show:!1,hide:!0}},orientation:"horizontal",openOnClick:!1,hoverDelay:100},enable:function(a,b){this._toggleDisabled(a,b!==!1)},disable:function(a){this._toggleDisabled(a,!1)},append:function(b,c){c=a(c);var d=this._insert(b,c,c.length?c.find("> .k-group, .k-animation-container > .k-group"):null);h(d.items,function(){d.group.append(this),N(this)}),M(c),N(d.group.find(".k-first, .k-last"))},insertBefore:function(b,c){c=a(c);var d=this._insert(b,c,c.parent());h(d.items,function(){c.before(this),N(this)}),N(c)},insertAfter:function(b,c){c=a(c);var d=this._insert(b,c,c.parent());h(d.items,function(){c.after(this),N(this)}),N(c)},_insert:function(b,c,d){var e=this;if(!c||!c.length)d=e.element;var g=a.isPlainObject(b),h,i={firstLevel:d.hasClass(n),horizontal:d.hasClass(n+"-horizontal"),expanded:!0,length:d.children().length};c&&!d.length&&(d=a(O.renderGroup({group:i})).appendTo(c)),g||a.isArray(b)?h=a.map(g?[b]:b,function(b,c){return a(O.renderItem({group:i,item:f(b,{index:c})}))}):(h=a(b),L(h));return{items:h,group:d}},remove:function(b){b=a(b);var c=this,d=b.parentsUntil(c.element,".k-item"),e=b.parent("ul");b.remove();if(e&&!e.children(".k-item").length){var f=e.parent(".k-animation-container");f.length?f.remove():e.remove()}d.length&&(d=d.eq(0),M(d),N(d))},open:function(b){var c=this;a(b).each(function(){var b=a(this);clearTimeout(b.data(s)),b.data(s,setTimeout(function(){var a=b.find(".k-group:first:hidden"),d;if(a[0]){b.data(x,b.css(x)),b.css(x,c.nextItemZIndex++),d=a.data(A);var e=b.parent().hasClass(n+"-horizontal");d||(d=a.kendoPopup({origin:e?"bottom left":"top right",position:"top left",collision:e?"fit":"fit flip",anchor:b,appendTo:b,animation:{open:f(J(b),c.options.animation.open),close:c.options.animation.close}}).data(A)),d.open()}},c.options.hoverDelay))})},close:function(b){var c=this;a(b).each(function(){var b=a(this);clearTimeout(b.data(s)),b.data(s,setTimeout(function(){var a=b.find(".k-group:first:visible"),c;a[0]&&(b.css(x,b.data(x)),b.removeData(x),c=a.data(A),c.close())},c.options.hoverDelay))})},_toggleDisabled:function(b,c){a(b).each(function(){a(this).toggleClass(C,c).toggleClass(D,!c)})},_toggleHover:function(b){var c=a(b.currentTarget);c.parents("li."+D).length||c.toggleClass("k-state-hover",b.type==y)},_updateClasses:function(){var a=this;a.element.addClass("k-widget k-reset k-header "+n).addClass(n+"-"+a.options.orientation);var b=a.element.find("ul").addClass("k-group").end().find("li").addClass("k-item");b.each(function(){L(this)})},_mouseenter:function(b){var c=this,d=a(b.currentTarget),e=d.children(".k-animation-container").length||d.children(".k-group").length;(!c.options.openOnClick||c.clicked)&&!K(b.currentTarget,b.relatedTarget)&&e&&c.trigger(m,{item:d[0]})===!1&&c.open(d),c.options.openOnClick&&c.clicked&&(c.trigger(q,{item:d[0]}),d.siblings().each(g(function(a,b){c.close(b)},c)))},_mouseleave:function(b){var c=this,d=a(b.currentTarget),e=d.children(".k-animation-container").length||d.children(".k-group").length;!c.options.openOnClick&&!K(b.currentTarget,b.relatedTarget)&&e&&c.trigger(q,{item:d[0]})===!1&&c.close(d)},_click:function(b){var c=this,d,f=a(b.currentTarget);if(f.hasClass(D))b.preventDefault();else{b.handled||c.trigger(w,{item:f[0]}),b.handled=!0;if(!f.parent().hasClass(n)||!c.options.openOnClick&&!e)return;b.preventDefault(),c.clicked=!0,d=f.children(".k-animation-container, .k-group").is(":visible")?q:m,c.trigger(d,{item:f[0]}),c[d](f)}},_documentClick:function(a){var b=this;K(b.element[0],a.target)||b.clicked&&(b.clicked=!1,b.close(b.element.find(".k-item>.k-animation-container:visible").parent()))}});f(O,{renderItem:function(a){a=f({menu:{},group:{}},a);var b=H.empty,c=a.item,d=a.menu;return H.item(f(a,{image:c.imageUrl?H.image:b,sprite:c.spriteCssClass?H.sprite:b,itemWrapper:H.itemWrapper,arrow:c.items?H.arrow:b,subGroup:O.renderGroup},I))},renderGroup:function(a){return H.group(f({renderItems:function(a){var b="",c=0,d=a.items,e=d?d.length:0,g=f({length:e},a.group);for(;c<e;c++)b+=O.renderItem(f(a,{group:g,item:f({index:c},d[c])}));return b}},a,I))}}),c.ui.plugin(O)})(jQuery)