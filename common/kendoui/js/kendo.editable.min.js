/*
* Kendo UI v2011.3.1129 (http://kendoui.com)
* Copyright 2011 Telerik AD. All rights reserved.
*
* Kendo UI commercial licenses may be obtained at http://kendoui.com/license.
* If you do not own a commercial license, this file shall be governed by the
* GNU General Public License (GPL) version 3. For GPL requirements, please
* review: http://www.gnu.org/copyleft/gpl.html
*/

(function(a,b){function n(a){var b=a.model.fields[a.field],d=b.type,e=b.validation,f,j=c.attr("type"),k,l={name:a.field};for(f in e)k=e[f],i(f,m)>=0?l[j]=f:g(k)||(l[f]=h(k)?k.value||f:k),l[c.attr(f+"-msg")]=k.message;i(d,m)>=0&&(l[j]=d);return l}var c=window.kendo,d=c.ui,e=d.Widget,f=a.extend,g=a.isFunction,h=a.isPlainObject,i=a.inArray,j=c.data.ModelViewBinder,k=d.Validator,l="change",m=["url","email","number","date","boolean"],o={number:function(b,d){var e=n(d);a('<input type="text"/>').attr(e).appendTo(b).kendoNumericTextBox({format:d.format}),a("<span "+c.attr("for")+'="'+d.field+'" class="k-invalid-msg"/>').hide().appendTo(b)},date:function(b,d){var e=n(d);e[c.attr("format")]=d.format,a('<input type="text"/>').attr(e).appendTo(b).kendoDatePicker({format:d.format}),a("<span "+c.attr("for")+'="'+d.field+'" class="k-invalid-msg"/>').hide().appendTo(b)},string:function(b,c){var d=n(c);a('<input type="text" class="k-input k-textbox"/>').attr(d).appendTo(b)},"boolean":function(b,c){var d=n(c);a('<input type="checkbox" />').attr(d).appendTo(b)}},p=e.extend({init:function(a,b){var c=this;e.fn.init.call(c,a,b),c.bind([l],c.options),c.refresh()},options:{name:"Editable",editors:o},editor:function(a,b){var c=this,d=c.options.editors,e=h(a),g=e?a.field:a,i=c.options.model||{},j=b&&b.type?b.type:"string",k=e&&a.editor?a.editor:d[j];k=k?k:d.string,b&&k(c.element,f(!0,{},e?a:{field:g},{model:i}))},_binderChange:function(a){var b=this;(!b.validatable.validate()||b.trigger(l,{values:a.values}))&&a.preventDefault()},end:function(){return this.binder.bindModel()},distroy:function(){this.element.removeData("kendoValidator").removeData("kendoEditable")},refresh:function(){var b=this,d,e,f=b.options.fields||[],i=b.element.empty(),k=b.options.model||{},m={},n={};a.isArray(f)||(f=[f]);for(d=0,e=f.length;d<e;d++){var o=f[d],p=h(o),q=p?o.field:o,r=(k.fields||{})[q],s=r?r.type:null,t=r?r.validation||{}:{};for(var u in t)g(t[u])&&(m[u]=t[u]);p&&o.format&&s=="date"&&(n[q]={format:function(a){return c.format(o.format,a)},parse:function(a){return c.parseDate(a,o.format)}}),b.editor(o,r)}n[l]=a.proxy(b._binderChange,b),b.binder=new j(i,b.options.model,n),b.validatable=i.kendoValidator({errorTemplate:'<div class="k-widget k-tooltip k-tooltip-validation" style="margin:0.5em"><span class="k-icon k-warning"> </span>${message}<div class="k-callout k-callout-n"></div></div>',rules:m}).data("kendoValidator"),i.find(":input:visible:first").focus()}});d.plugin(p)})(jQuery)