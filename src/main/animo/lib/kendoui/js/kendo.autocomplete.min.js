/*
* Kendo UI v2011.3.1129 (http://kendoui.com)
* Copyright 2011 Telerik AD. All rights reserved.
*
* Kendo UI commercial licenses may be obtained at http://kendoui.com/license.
* If you do not own a commercial license, this file shall be governed by the
* GNU General Public License (GPL) version 3. For GPL requirements, please
* review: http://www.gnu.org/copyleft/gpl.html
*/

(function(a,b){function v(a){var b=a.value.length;q(a,b,b)}function u(a,b,c,d){var e=b.split(d);e.splice(s(a,b,d),1,c),e[e.length-1]!==""&&e.push("");return e.join(d)}function t(a,b,c){return b.split(c)[s(a,b,c)]}function s(a,b,c){return b.substring(0,a).split(c).length-1}var c=window.kendo,d=c.support.touch,e=c.ui,f=c.data.DataSource,g=e.List,h="change",i="k-state-default",j="disabled",k="k-state-focused",l="k-state-selected",m="k-state-disabled",n="k-state-hover",o="mouseenter mouseleave",p=g.caret,q=g.selectText,r=a.proxy,w=g.extend({init:function(b,c){var d=this;c=a.isArray(c)?{dataSource:c}:c,g.fn.init.call(d,b,c),b=d.element,d._wrapper(),d._accessors(),d.dataSource=f.create(d.options.dataSource).bind(h,r(d.refresh,d)),d.bind([h],d.options),b[0].type="text",b.attr("autocomplete","off").addClass("k-input").bind({keydown:r(d._keydown,d),paste:r(d._search,d),focus:function(){d._old=d.value(),d.wrapper.addClass(k)},blur:function(){d._bluring=setTimeout(function(){d._blur(),d.wrapper.removeClass(k)},100)}}),d.enable(!b.is("[disabled]")),d._popup()},options:{name:"AutoComplete",suggest:!1,minLength:1,delay:200,height:200,filter:"startswith"},enable:function(a){var b=this,c=b.element,d=b.wrapper;a===!1?(d.removeClass(i).addClass(m).unbind(o),c.attr(j,j)):(d.removeClass(m).addClass(i).bind(o,b._toggleHover),c.removeAttr(j))},close:function(){var a=this;a._current=null,a.popup.close()},refresh:function(){var b=this,d=b.ul[0],e=b.dataSource.view(),f=e.length;d.innerHTML=c.render(b.template,e),b._height(f),f&&b.options.highlightFirst&&b.current(a(d.firstChild)),b._open&&(b._open=!1,b.popup[f?"open":"close"]())},select:function(b){var c=this,d=c.options.separator,e=c.dataSource.view(),f,h;b=a(b),b[0]&&!b.hasClass(l)&&(h=g.inArray(b[0],c.ul[0]),h>-1&&(e=e[h],f=c._text(e),d&&(f=u(p(c.element[0]),c.value(),f,d)),c.value(f),c.current(b.addClass(l))))},search:function(a){var b=this,a=a||b.value(),c=b.options,d=c.separator,e,f,g;b._current=null,clearTimeout(b._typing),d&&(a=t(p(b.element[0]),a,d)),e=a.length,e?e>=b.options.minLength&&(b._open=!0,b.dataSource.filter({field:c.dataTextField,operator:c.filter,value:a})):b.popup.close()},suggest:function(a){var b=this,c=b.element[0],d=b.options.separator,e=b.value(),f,g,h=p(c);typeof a!="string"&&(a=a?a.text():""),h<=0&&(h=e.toLowerCase().indexOf(a.toLowerCase())+1),a||(a=e.substring(0,h),d&&(a=a.split(d).pop())),d&&(a=u(h,e,a,d)),a!==e&&(b.value(a),f=a.length,d&&(f=h+a.substring(h).indexOf(d)),q(c,h,f))},value:function(a){var c=this,d=c.element[0];if(a!==b)d.value=a;else return d.value},_accept:function(a){var b=this;c.support.touch?setTimeout(function(){b._focus(a)},0):b._focus(a),v(b.element[0])},_move:function(a){var b=this;a=a[0]?a:null,b.current(a),b.options.suggest&&b.suggest(a)},_keydown:function(b){var d=this,e=d.ul[0],f=b.keyCode,g=c.keys,h=d._current,i=d.popup.visible();f===g.DOWN?(i&&d._move(h?h.next():a(e.firstChild)),b.preventDefault()):f===g.UP?(i&&d._move(h?h.prev():a(e.lastChild)),b.preventDefault()):f===g.ENTER||f===g.TAB?(d.popup.visible()&&b.preventDefault(),d._accept(h)):f===g.ESC?d.close():d._search()},_search:function(){var a=this;clearTimeout(a._typing),a._typing=setTimeout(function(){a._old!==a.value()&&(a._old=a.value(),a.search())},a.options.delay)},_toggleHover:function(b){d||a(b.currentTarget).toggleClass(n,b.type==="mouseenter")},_wrapper:function(){var a=this,b=a.element,c=b[0],d="tabIndex",e;e=b.parent(),e.is("span.k-widget")||(e=b.wrap("<span />").parent()),e[0].style.cssText=c.style.cssText,b.css({width:"100%",height:"auto"}),a._focused=a.element,a.wrapper=e.addClass("k-widget k-autocomplete k-header").addClass(c.className)}});e.plugin(w)})(jQuery)