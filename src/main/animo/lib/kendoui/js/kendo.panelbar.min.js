/*
* Kendo UI v2011.3.1129 (http://kendoui.com)
* Copyright 2011 Telerik AD. All rights reserved.
*
* Kendo UI commercial licenses may be obtained at http://kendoui.com/license.
* If you do not own a commercial license, this file shall be governed by the
* GNU General Public License (GPL) version 3. For GPL requirements, please
* review: http://www.gnu.org/copyleft/gpl.html
*/

(function(a,b){function R(b){b=a(b),b.filter(".k-first:not(:first-child)").removeClass(r),b.filter(".k-last:not(:last-child)").removeClass(l),b.filter(":first-child").addClass(r),b.filter(":last-child").addClass(l)}function Q(b){b=a(b),b.children(".k-link").children(".k-icon").remove(),b.filter(":has(.k-group),:has(.k-content)").children(".k-link:not(:has([class*=k-arrow]))").each(function(){var b=a(this),c=b.parent();b.append("<span class='k-icon "+(c.hasClass(A.substr(1))?"k-arrow-up k-panelbar-collapse":"k-arrow-down k-panelbar-expand")+"'/>")})}function P(b,c){b=a(b).addClass("k-item"),b.children(j).addClass(q),b.children("a").addClass(m).children(j).addClass(q),b.filter(":not([disabled]):not([class*=k-state])").addClass("k-state-default"),b.filter("li[disabled]").addClass("k-state-disabled").removeAttr("disabled"),b.filter(":not([class*=k-state])").children("a:focus").parent().addClass(A.substr(1)),b.find(">div").addClass(u).css({display:"none"}),b.each(function(){var b=a(this);b.children("."+m).length||b.contents().filter(function(){return!this.nodeName.match(i)&&(this.nodeType!=3||!!a.trim(this.nodeValue))}).wrapAll("<span class='"+m+"'/>")}),c.find(" > li > ."+m).addClass("k-header")}var c=window.kendo,d=c.ui,e=a.extend,f=a.each,g=c.template,h=d.Widget,i=/^(ul|a|div)$/i,j="img",k="href",l="k-last",m="k-link",n="error",o="click",p=".k-item",q="k-image",r="k-first",s="expand",t="select",u="k-content",v="collapse",w="contentUrl",x="mouseenter",y="mouseleave",z="contentLoad",A=".k-state-active",B="> .k-group",C="> .k-content",D=".k-state-selected",E=".k-state-disabled",F=".k-state-highlighted",G=p+":not(.k-state-disabled) .k-link",H=p+".k-state-disabled .k-link",I="k-state-default",J=":visible",K=":empty",L="single",M=!1,N={content:g("<div class='k-content'#= contentAttributes(data) #>#= content(item) #</div>"),group:g("<ul class='#= groupCssClass(group) #'#= groupAttributes(group) #>#= renderItems(data) #</ul>"),itemWrapper:g("<#= tag(item) # class='#= textClass(item, group) #'#= contentUrl(item) ##= textAttributes(item) #>#= image(item) ##= sprite(item) ##= text(item) ##= arrow(data) #</#= tag(item) #>"),item:g("<li class='#= wrapperCssClass(group, item) #'>#= itemWrapper(data) ## if (item.items) { ##= subGroup({ items: item.items, panelBar: panelBar, group: { expanded: item.expanded } }) ## } #</li>"),image:g("<img class='k-image' alt='' src='#= imageUrl #' />"),arrow:g("<span class='#= arrowClass(item, group) #'></span>"),sprite:g("<span class='k-sprite #= spriteCssClass #'></span>"),empty:g("")},O={wrapperCssClass:function(a,b){var c="k-item",d=b.index;b.enabled===!1?c+=" k-state-disabled":c+=" k-state-default",d==0&&(c+=" k-first"),d==a.length-1&&(c+=" k-last");return c},textClass:function(a,b){var c=m;b.firstLevel&&(c+=" k-header");return c},textAttributes:function(a){return a.url?" href='"+a.url+"'":""},arrowClass:function(a,b){var c="k-icon";b.horizontal?c+=" k-arrow-down":c+=" k-arrow-right";return c},text:function(a){return a.encoded===!1?a.text:c.htmlEncode(a.text)},tag:function(a){return a.url?"a":"span"},groupAttributes:function(a){return a.expanded!==!0?" style='display:none'":""},groupCssClass:function(a){return"k-group"},contentAttributes:function(a){return a.active!==!0?" style='display:none'":""},content:function(a){return a.content?a.content:a.contentUrl?"":"&nbsp;"},contentUrl:function(a){return a.contentUrl?c.attr("content-url")+'="'+a.contentUrl+'"':""}},S=h.extend({init:function(b,c){b=a(b);var d=this,e;h.fn.init.call(d,b,c),c=d.options,d.element.is(K)&&d.element.append(a(S.renderGroup({items:c.dataSource,group:{firstLevel:!0,expanded:!0},panelBar:{}})).children()),d._updateClasses(),c.animation===!1&&(c.animation={open:{show:!0,effects:{}},close:{hide:!0,effects:{}}}),b.delegate(G,o,a.proxy(d._click,d)).delegate(G,x+" "+y,d._toggleHover).delegate(H,o,!1),d.bind([s,v,t,n,z],d.options),d.options.contentUrls&&b.find("> .k-item").each(function(b,c){a(c).find("."+m).data(w,d.options.contentUrls[b])}),e=b.find("li"+A+" > ."+u),e.length>0&&d.expand(e.parent(),!1)},options:{name:"PanelBar",animation:{open:{effects:"expandVertical",duration:200,show:!0},close:{duration:200,show:!1,hide:!0}},expandMode:"multiple"},expand:function(b,c){var d=this,e={};c=c!==!1,a(b).each(function(f,g){g=a(g);var h=g.find(B).add(g.find(C));if(!g.hasClass(E)&&h.length>0){if(d.options.expandMode==L&&d._collapseAllExpanded(g))return;b.find(F).removeClass(F.substr(1)),g.addClass(F.substr(1)),c||(e=d.options.animation,d.options.animation={open:{show:!0,effects:{}},close:{hide:!0,effects:{}}}),d._toggleItem(g,!1,null),c||(d.options.animation=e)}})},collapse:function(b,c){var d=this,e={};c=c!==!1,a(b).each(function(b,f){f=a(f);var g=f.find(B).add(f.find(C));!f.hasClass(E)&&g.is(J)&&(f.removeClass(F.substr(1)),c||(e=d.options.animation,d.options.animation={open:{show:!0,effects:{}},close:{hide:!0,effects:{}}}),d._toggleItem(f,!0,null),c||(d.options.animation=e))})},toggle:function(b,c){a(b).toggleClass(I,c).toggleClass(E.substr(1),!c)},select:function(b){var c=this;if(arguments.length===0)return c.element.find(".k-item > "+D).parent();a(b).each(function(b,d){d=a(d);var e=d.children("."+m);d.is(E)||(a(D,c.element).removeClass(D.substr(1)),a(F,c.element).removeClass(F.substr(1)),e.addClass(D.substr(1)),e.parentsUntil(c.element,p).filter(":has(.k-header)").addClass(F.substr(1)))})},enable:function(a,b){this.toggle(a,b!==!1)},disable:function(a){this.toggle(a,!1)},append:function(b,c){c=a(c);var d=this._insert(b,c,c.length?c.find("> .k-group"):null);f(d.items,function(b){d.group.append(this);var c=d.contents[b];c&&a(this).append(c),R(this)}),Q(c),R(d.group.find(".k-first, .k-last")),d.group.height("auto")},insertBefore:function(b,c){c=a(c);var d=this._insert(b,c,c.parent());f(d.items,function(b){c.before(this);var e=d.contents[b];e&&a(this).append(e),R(this)}),R(c),d.group.height("auto")},insertAfter:function(b,c){c=a(c);var d=this._insert(b,c,c.parent());f(d.items,function(b){c.after(this);var e=d.contents[b];e&&a(this).append(e),R(this)}),R(c),d.group.height("auto")},remove:function(b){b=a(b);var c=this,d=b.parentsUntil(c.element,p),e=b.parent("ul");b.remove(),e&&!e.children(p).length&&e.remove(),d.length&&(d=d.eq(0),Q(d),R(d))},_insert:function(b,c,d){var f=this,g=[];if(!c||!c.length)d=f.element;var h=a.isPlainObject(b),i,j={firstLevel:d.hasClass("k-panelbar"),expanded:d.parent().hasClass("k-state-active"),length:d.children().length};c&&!d.length&&(d=a(S.renderGroup({group:j})).appendTo(c)),h||a.isArray(b)?(i=a.map(h?[b]:b,function(b,c){return typeof b=="string"?a(b):a(S.renderItem({group:j,item:e(b,{index:c})}))}),g=a.map(h?[b]:b,function(b,c){return b.content||b.contentUrl?a(S.renderContent({item:e(b,{index:c})})):!1})):(i=a(b),P(i,f.element));return{items:i,group:d,contents:g}},_toggleHover:function(b){var c=a(b.currentTarget);c.parents("li"+E).length||c.toggleClass("k-state-hover",b.type==x)},_updateClasses:function(){var a=this;a.element.addClass("k-widget k-reset k-header k-panelbar");var b=a.element.find("ul").addClass("k-group").end().find("li:not("+A+") > ul").css({display:"none"}).end().find("li");b.each(function(){P(this,a.element)}),Q(b),R(b)},_click:function(b){var c=this,d=a(b.currentTarget),e=c.element;if(!d.parents("li"+E).length){if(d.closest(".k-widget")[0]!=e[0])return;var f=d.closest("."+m),g=f.closest(p);a(D,e).removeClass(D.substr(1)),a(F,e).removeClass(F.substr(1)),f.addClass(D.substr(1)),f.parentsUntil(c.element,p).filter(":has(.k-header)").addClass(F.substr(1));var h=g.find(B).add(g.find(C)),i=f.attr(k),j=f.data(w)||i&&(i.charAt(i.length-1)=="#"||i.indexOf("#"+c.element[0].id+"-")!=-1);if(h.data("animating"))return;c._triggerEvent(t,g)&&b.preventDefault();if(j||h.length)b.preventDefault();else return;if(c.options.expandMode==L&&c._collapseAllExpanded(g))return;if(h.length){var l=h.is(J);c._triggerEvent(l?v:s,g)||c._toggleItem(g,l,b)}}},_toggleItem:function(a,b,c){var d=this,e=a.find("> .k-group");if(e.length)this._toggleGroup(e,b),c&&c.preventDefault();else{var f=a.find("> ."+u);f.length&&(c&&c.preventDefault(),f.is(K)?d._ajaxRequest(a,f,b):d._toggleGroup(f,b))}},_toggleGroup:function(a,b){var c=this,d="effects"in c.options.animation.close,f=e({},c.options.animation.open);a.is(J)==b&&(b&&a.css("height",a.height()),a.css("height"),a.parent().toggleClass(I,b).toggleClass(A.substr(1),!b).find("> .k-link > .k-icon").toggleClass("k-arrow-up",!b).toggleClass("k-panelbar-collapse",!b).toggleClass("k-arrow-down",b).toggleClass("k-panelbar-expand",b),a.kendoStop(!0,!0).kendoAnimate(e(d&&b?c.options.animation.close:!d&&b?e(f,{show:!1,hide:!0}):c.options.animation.open,{reverse:!d&&b})))},_collapseAllExpanded:function(b){var c=this;if(b.find("> ."+m).hasClass("k-header")){var d=b.find(B).add(b.find(C));if(d.is(J)||d.length==0)return!0;var e=a(c.element).children();e.find(B).add(e.find(C)).filter(function(){return a(this).is(J)}).each(function(b,d){c._toggleGroup(a(d),!0)})}},_ajaxRequest:function(b,c,d){var e=this,f=b.find(".k-panelbar-collapse, .k-panelbar-expand"),g=b.find("."+m),h=setTimeout(function(){f.addClass("k-loading")},100),i={};a.ajax({type:"GET",cache:!1,url:g.data(w)||g.attr(k),dataType:"html",data:i,error:function(a,b){e.trigger(n,{xhr:a,status:b})&&this.complete()},complete:function(){clearTimeout(h),f.removeClass("k-loading")},success:function(a,f){c.html(a),e._toggleGroup(c,d),e.trigger(z,{item:b[0],contentElement:c[0]})}})},_triggerEvent:function(a,b){var c=this;c.trigger(a,{item:b[0]})}});e(S,{renderItem:function(a){a=e({panelBar:{},group:{}},a);var b=N.empty,c=a.item,d=a.panelBar;return N.item(e(a,{image:c.imageUrl?N.image:b,sprite:c.spriteCssClass?N.sprite:b,itemWrapper:N.itemWrapper,arrow:c.items?N.arrow:b,subGroup:S.renderGroup},O))},renderGroup:function(a){return N.group(e({renderItems:function(a){var b="",c=0,d=a.items,f=d?d.length:0,g=e({length:f},a.group);for(;c<f;c++)b+=S.renderItem(e(a,{group:g,item:e({index:c},d[c])}));return b}},a,O))},renderContent:function(a){return N.content(e(a,O))}}),c.ui.plugin(S)})(jQuery)